# enable command auto-correction
setopt CORRECT

# enable command history
HISTSIZE=1000
SAVEHIST=1000
HISTFILE=~/.zsh_history

# homebrew and path hacking 
eval "$(/opt/homebrew/bin/brew shellenv)"
export PATH="$(brew --prefix coreutils)/libexec/gnubin:$PATH"

# asdf
. "$(brew --prefix asdf)/libexec/asdf.sh"

# user binaries
export PATH="$HOME/.local/bin:$PATH"

# npm global packages
export PATH="$HOME/.config/npm/global/bin:$PATH"

# direnv
eval "$(direnv hook zsh)"

# rust
source "$HOME/.cargo/env"

# starship
eval "$(starship init zsh)"

# kubernetes
export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"

# load functions and aliases
for file in ~/.{exports,aliases,functions,work}; do
  [ -r "$file" ] && source "$file"
done
unset file

# shell configuration
setopt promptsubst
setopt autocd                   # change directory by typing directory name
setopt interactivecomments      # allow comments in interactive shell
setopt magicequalsubst          # enable filename expansion for arguments of the form 'anything=expression'
setopt nonomatch                # hide error message if there is no match for the pattern
setopt notify                   # report background jobs status immediately
setopt numericglobsort          # sort filenames numerically when it makes sense

# initialize and load Zsh autocompletion
autoload -Uz +X compinit && compinit

# case-insensitive path-completion
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'

# enable menu-based selection of completion options
zstyle ':completion:*' menu select

# completion enhancements from p3rception
zstyle ':completion:*' special-dirs true               # complete . and .. special directories
zstyle ':completion:*' list-colors ''                 # enable colored completion listings
zstyle ':completion:*:*:kill:*:processes' list-colors '=(#b) #([0-9]#) ([0-9a-z-]#)*=01;34=0=01'
zstyle ':completion:*:*:*:*:processes' command "ps -u $USER -o pid,user,comm -w -w"
