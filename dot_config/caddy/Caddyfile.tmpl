# Global options
{
  # Issue certs for .test with Caddy's internal CA
  certificates {
    automate *.test
    issuers internal
  }

  # Access logs to stdout
  logging {
    logs {
      default {
        level INFO
        output stdout
      }
    }
  }

  # Turn on HTTPâ†’HTTPS and HTTP/3
  servers {
    protocol {
      experimental_http3
    }
    metrics off
  }
}

# Reusable dev snippet
(dev_common) {
  encode zstd gzip
  header {
    # Helpful in dev
    X-Frame-Options SAMEORIGIN
    X-Content-Type-Options nosniff
  }
  log
}

# Default catch-all for undefined .test domains
*.test {
  import dev_common
  respond "No service configured for {host}" 404
}
